---
import * as ToggleDarkModeStyled from "./ToggleDarkMode.styled";
import Icon from "@/components/Icon/Icon.astro";
import { VARS } from "@/styles";

const iconSize = `calc(${VARS.component.button.s.iconSize} - var(--padding) * 2)`;
---

<ToggleDarkModeStyled.Component
  className="dark-mode-toggle"
  title="Alternar tema"
>
  <div class="switch">
    <Icon
      faIcon="fa-solid fa-sun"
      style={{ size: iconSize }}
      handlingClass={["sun"]}
    />
    <Icon
      faIcon="fa-solid fa-moon"
      style={{ size: iconSize }}
      handlingClass={["moon"]}
    />
  </div>
</ToggleDarkModeStyled.Component>

<script>
  import { bodyManager } from "@/tools/elementManagers.tool";
  import { darkModeEntity } from "@/services";

  const darkModeToggles = window.document.querySelectorAll(".dark-mode-toggle");

  darkModeToggles.forEach((item) =>
    item.addEventListener("click", () => {
      const reverseDarkMode = !(bodyManager.getData("darkMode") === "true");

      bodyManager.setData("darkMode", String(reverseDarkMode));
      darkModeEntity.set(reverseDarkMode);
    }),
  );
</script>
