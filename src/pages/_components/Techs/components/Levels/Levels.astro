---
import './Levels.css'
import jsonData from '@/content/data.json'

const { levels } = jsonData.pages.home.sections.techs.data
---

<fieldset class="levels">
  {
    levels.map(({ level, desc }, i) => {
      const id = `level-${i}`

      return (
        <label class="bg card layout" for={id}>
          <input class="level-toggle" {id} type="checkbox" checked />
          <div class="group">
            <span />
            {level}
          </div>
          <p class="text">{desc}</p>
        </label>
      )
    })
  }
</fieldset>

<script>
  import { $$, onPageLoad } from '@/tools'

  onPageLoad(() => {
    const levelToggles = $$<HTMLInputElement>('.level-toggle')
    const treeviews = $$<HTMLElement>('.cmp-treeview')

    levelToggles.forEach((toggle, index) => {
      toggle.onchange = event => {
        const element = event.target as HTMLInputElement
        const { checked } = element

        treeviews.forEach(treeview =>
          treeview.style.setProperty(
            `--level-${index}-opacity`,
            checked ? '1' : '0.25'
          )
        )
      }
    })
  })
</script>
